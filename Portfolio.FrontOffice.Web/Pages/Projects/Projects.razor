@attribute [Route("/" + Portfolio.FrontOffice.Web.Routing.WebRoutes.Projects)]
@using Portfolio.FrontOffice.Common
@using Portfolio.FrontOffice.Web.Pages.Projects
@inject HttpClient Http

<Spinner IsLoading=@isLoading>
    @foreach (var project in projectModels)
    {
        <ProjectCard ProjectModel=@project 
                     EmployerName=@employers.SingleOrDefault(e => e.EmployerId == project.EmployerId)?.Name />
    }
</Spinner>

@code {
    private bool isLoading = true;

    private ProjectModel[] projectModels;

    private EmployerModel[] employers;

    protected override async Task OnInitializedAsync()
    {
        projectModels = await Http.GetFromJsonAsync<ProjectModel[]>(ApiRoutes.Projects);
        employers = await Http.GetFromJsonAsync<EmployerModel[]>(ApiRoutes.Employers);
        isLoading = false;
    }
}
